<header ng-include src="'partials/header.html'"></header>
<div class="return">
<!-- Merchant Block -->
	<div ng-if="isMerchant && returnDetails != null">
		<h1>
			<a href="javascript:void(0);" ng-if="returnDetails.cartItem.url" ng-click="getProductDetails(returnDetails.cartItem.urlid)">{{returnDetails.name}}</a>
			<span ng-if="!returnDetails.cartItem.url">{{returnDetails.name}}</span>
		</h1>
		<div ng-repeat="item in returnDetails.returnedItems" class="panel panel-default">
			<div class="panel-heading"><h3 class="panel-title">{{item.date | date:'dd/MM/yyyy'}}</h3></div>
			<div class="panel-body">
				<form role="form" class="form-horizontal">
					<div class="form-group" style="margin-bottom: 0px;">
						<div class="col-xs-12 col-sm-6 col-md-3 col-lg-3" style="padding:0px 5px; margin-bottom: 15px;">
							<label for="returnQuantity-{{$index}}">Quantity</label>
							<input type="text" class="form-control" id="returnQuantity-{{$index}}" readonly value="{{item.quantity}}"/>
						</div>
						<div class="col-xs-12 col-sm-6 col-md-3 col-lg-3" style="padding:0px 5px; margin-bottom: 15px;">
							<label for="returnItemStatus-{{$index}}">Return Item Status</label>
							<select class="form-control" id="returnItemStatus-{{$index}}" ng-model="returnItemStatusTab[$index]" ng-options="option.value as option.label for option in returnItemStatusOptions"></select>
						</div>
						<div class="col-xs-12 col-sm-6 col-md-3 col-lg-3" style="padding:0px 5px; margin-bottom: 15px;">
							<label for="returnRefunded-{{$index}}">Refunded</label>
							<input type="text" class="form-control" ng-disabled="item.boReturns[0].status != 'RETURN_RECEIVED'" ng-required="item.boReturns[0].status != 'RETURN_RECEIVED'" id="returnRefunded-{{$index}}" ng-model="refundedValue[$index]" pattern="\d+" ng-blur="checkTotalRefundedValidity($index)"/>
						</div>
						<div class="col-xs-12 col-sm-6 col-md-3 col-lg-3" style="padding:0px 5px; margin-bottom: 15px;">
							<label for="returnTotalRefunded-{{$index}}">Total Refunded</label>
							<input type="text" class="form-control" ng-disabled="item.boReturns[0].status != 'RETURN_RECEIVED'" ng-required="item.boReturns[0].status != 'RETURN_RECEIVED'" id="returnTotalRefunded-{{$index}}" ng-model="totalRefundedValue[$index]" pattern="\d+" ng-blur="checkTotalRefundedValidity($index)"/>
						</div>
					</div>
				</form>
				<div class="form-group" style="margin-bottom: 0px;" ng-if="item.boReturns[0].status != 'RETURN_REFUSED' && item.boReturns[0].status != 'RETURN_ACCEPTED'">
					<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" style="padding:0px 5px; margin-bottom: 15px;">
						<label for="returnMotivation-{{$index}}">Motivation</label>
						<textarea class="form-control" id="returnMotivation-{{$index}}" rows="3"></textarea>
					</div>
				</div>
				<div class="clearfix"></div>
				<div class="table-responsive" ng-show="returnDetails.returnedItems.length > 0">
					<table class="table table-bordered table-striped">
						<thead>
							<tr>
								<th>Status</th>
								<th>Motivation</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="return in item.boReturns">
								<td>{{returnStatusValues[return.status]}}</td>
								<td>{{return.motivation}}</td>
							</tr>
						</tbody>
					</table>
				</div>
				<button class="btn btn-success pull-right" ng-if="item.boReturns[0].status == 'RETURN_SUBMITTED' || item.boReturns[0].status == 'RETURN_RECEIVED'" style="margin-right: 10px;" ng-click="acceptReturn($index)">
					Accept Return<span ng-if="item.boReturns[0].status == 'RETURN_SUBMITTED'"> Request</span>
				</button>
				<button class="btn btn-danger pull-right" ng-if="item.boReturns[0].status == 'RETURN_SUBMITTED' || item.boReturns[0].status == 'RETURN_RECEIVED'" style="margin-right: 10px;" ng-click="refuseReturn($index)">
					Refuse Return<span ng-if="item.boReturns[0].status == 'RETURN_SUBMITTED'"> Request</span>
				</button>
				<button class="btn btn-primary pull-right" ng-if="item.boReturns[0].status == 'RETURN_TO_BE_RECEIVED'" style="margin-right: 10px;" ng-click="receiveReturn($index)">
					Return Received
				</button>
			</div>
		</div>
	</div>
<!-- End Of Merchant Block -->

<!-- Customer Block -->
	<div ng-if="!isMerchant && itemsToBeReturned != null">
		<div ng-repeat="item in itemsToBeReturned" class="panel panel-default">
			<div class="panel-heading"><h3 class="panel-title">{{item.bOProducts[0].product.name}}/({{item.sku.sku}})</h3></div>
			<div class="panel-body">
				<form role="form" class="form-horizontal">
					<div class="form-group" style="margin-bottom: 0px;">
						<div class="col-xs-12 col-sm-3 col-md-3 col-lg-3" style="padding:0px 5px; margin-bottom: 15px;">
							<label for="toBeReturnedQuantity-{{$index}}">Quantity</label>
							<input type="text" class="form-control" id="toBeReturnedQuantity-{{$index}}" pattern="[1-9]?\d+" required />
						</div>
						<div class="col-xs-12 col-sm-9 col-md-9 col-lg-9" style="padding:0px 5px; margin-bottom: 15px;">
							<label for="toBeReturnedMotivation-{{$index}}">Motivation</label>
							<textarea class="form-control" id="toBeReturnedMotivation-{{$index}}" required></textarea>
						</div>
					</div>
				</form>
			</div>
		</div>
		<button class="btn btn-primary pull-right" style="margin-right: 10px;" ng-click="submitReturnItems()">Submit</button>
	</div>
<!-- End Of Customer Block -->
</div>