<!--
  ~ Copyright (C) 2015 Mogobiz SARL. All rights reserved.
  -->

<header ng-include src="'partials/header.html'"></header>
<ul class="nav nav-tabs">
    <li ng-if="isMerchant==false" class="active"><a href="javascript:void(0)" data-target="#profileInfo" data-toggle="tab">Customer Info</a></li>
    <li ng-if="isMerchant==true" class="active"><a href="javascript:void(0)" data-target="#profileInfo" data-toggle="tab">Merchant Info</a></li>
    <li ng-if="isMerchant==true"><a href="javascript:void(0)" data-target="#creditCard" data-toggle="tab">Credit Card</a></li>
    <li ng-if="isMerchant==true"><a href="javascript:void(0)" data-target="#paypal" data-toggle="tab">Paypal</a></li>
    <li ng-if="isMerchant==true"><a href="javascript:void(0)" data-target="#kwixo" data-toggle="tab">Kwixo</a></li>
    <li ng-if="isMerchant==true"><a href="javascript:void(0)" data-target="#applePay" data-toggle="tab">Apple Pay</a></li>
    <li ng-if="isMerchant==true"><a href="javascript:void(0)" data-target="#auth" data-toggle="tab">Auth</a></li>
    <li ng-if="isMerchant==true"><a href="javascript:void(0)" data-target="#groupPayment" data-toggle="tab">Group Payment</a></li>
    <li ng-if="isMerchant==true && createPage==false"><a href="javascript:void(0)" data-target="#emailInfo" data-toggle="tab">Email info</a></li>
</ul>

<div class="tab-content container-fluid editProfile">
	<div class="tab-pane active" id="profileInfo">
		<div ng-if="createPage==false">
			<fieldset>
				<legend ng-if="isMerchant==true"> Merchant info </legend>
				<legend ng-if="isMerchant==false"> Customer info </legend>
				<form role="form" class="form-horizontal">
					<div class="form-group">
						<div class="col-xs-5 col-sm-3 col-md-3 col-lg-3" style="padding:0px 3px;">
							<label ng-if="isMerchant==true">Merchant ID</label>
							<label ng-if="isMerchant==false">Customer ID</label>
						</div>
						<div class="col-xs-7 col-sm-9 col-md-9 col-lg-9" style="padding:0px 3px;">
							<label>{{userProfile.account.uuid}}</label>
						</div>
					</div>
					<div class="form-group">
						<div class="col-xs-5 col-sm-3 col-md-3 col-lg-3" style="padding:0px 3px;">
							<label ng-if="isMerchant==true">Secret Merchant UUID</label>
							<label ng-if="isMerchant==false">Secret Customer UUID</label>
						</div>
						<div class="col-xs-7 col-sm-9 col-md-9 col-lg-9" style="padding:0px 3px;">
							<label ng-show="!showUserUUID">XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX</label>
							<label ng-show="showUserUUID">{{userUUID}}</label>
							<input type="button" ng-show="!showUserUUID" value="Display" class="btn btn-default" ng-click="displayUserUUID()"/>
							<input type="button" ng-show="showUserUUID" value="Hide" class="btn btn-default" ng-click="displayUserUUID()"/>
							<input type="button"  value="Renew" class="btn btn-default" ng-click="renewUserUUID()"/>
						</div>
					</div>
				</form>
			</fieldset>
		</div>
		<fieldset>
			<legend > Contact info </legend>
			<form role="form" class="form-horizontal">
				<div class="form-group">
					<div style="padding:0px 3px;">
						<label for="profileEmail">Email</label>
					</div>
					<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
						<input type="email" class="form-control" id="profileEmail" placeholder="Enter email" required autofocus value="{{userProfile.account.email}}" ng-disabled="createPage==false" pattern="[a-zA-Z0-9._-]+\@([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,4}" />
					</div>
					<div class="col-xs-4 col-sm-6 col-md-6 col-lg-6" style="padding:7px 3px 0px 0px;">
						<a href="javascript:void(0)" ng-if="userProfile.account.status.name == 'WAITING_ENROLLEMENT'" ng-click="profileResendMailConfirmation()">
							Re-send Confirmation request
						</a>
					</div>
				</div>
				<div class="form-group" ng-if="createPage==true">
					<div style="padding:0px 3px;">
						<label for="profilePassword">Password</label>
					</div>
					<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
						<input type="password" class="form-control" id="profilePassword" placeholder="Password" required/>
					</div>
				</div>
				<div class="form-group" ng-if="createPage==true">
					<div style="padding:0px 3px;">
						<label for="profileConfirmPassword">Confirm Password</label>
					</div>
					<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
						<input type="password" class="form-control" id="profileConfirmPassword" placeholder="Confirm Password" required ng-blur="profileCheckPasswordConfrimation()"/>
					</div>
				</div>
				<div class="form-group" ng-if="isMerchant==true">
					<div style="padding:0px 3px;">
						<label for="profileCompanyName">Company Name</label>
					</div>
					<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
						<input type="text" class="form-control" id="profileCompanyName" placeholder="Company Name" pattern="[^<]+" required value="{{userProfile.account.company}}"/>
					</div>
				</div>
				<div class="form-group" ng-if="isMerchant==true">
					<div style="padding:0px 3px;">
						<label for="profileWebsite">Website</label>
					</div>
					<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
						<input type="text" class="form-control" id="profileWebsite" placeholder="Website" pattern="https?://([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,4}((\/[^\/~,]+)+)?/?" required value="{{userProfile.account.website}}"/>
					</div>
				</div>
				<div class="form-group">
					<div style="padding:0px 3px;">
						<label for="profilePhoneNumber">Phone number</label>
					</div>
					<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
						<input type="text" class="form-control" id="profilePhoneNumber" placeholder="Phone number" required value="{{userProfile.account.address.telephone.lphone}}" ng-blur="profileCheckPhoneNumberForCountry()"/>
					</div>
					<div class="col-xs-4 col-sm-6 col-md-6 col-lg-6" style="padding:7px 3px 0px 0px;">
						<a href="javascript:void(0)" ng-if="userProfile.account.address.telephone.status.name == 'WAITING_ENROLLEMENT'" ng-click="profileResendPhoneValidation()">
							Re-send Phone validation request
						</a>
					</div>
				</div>
			</form>
		</fieldset>
		<fieldset>
			<legend > Personal info </legend>
			<form role="form" class="form-horizontal">
				<div class="form-group">
					<div style="padding:0px 3px;">
						<label for="profileCivility">Civility</label>
					</div>
					<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
						<select id="profileCivility" class="form-control" ng-model="profileCivilityModel" ng-options="obj.name for obj in profileCivilityOptions"></select>
					</div>
				</div>
				<div class="form-group">
					<div style="padding:0px 3px;">
						<label for="profileFirstName">First name</label>
					</div>
					<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
						<input type="text" class="form-control" id="profileFirstName" placeholder="First name" required value="{{userProfile.account.firstName}}"/>
					</div>
				</div>
				<div class="form-group">
					<div style="padding:0px 3px;">
						<label for="profileLastName">Last name</label>
					</div>
					<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
						<input type="text" class="form-control" id="profileLastName" placeholder="Last name" required value="{{userProfile.account.lastName}}"/>
					</div>
				</div>
				<div class="form-group">
					<div style="padding:0px 3px;">
						<label for="profileBirthDate">Birthdate</label>
					</div>
					<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
						<input type="date" class="form-control" max="{{maxBirthDate}}" min="{{minBirthDate}}" id="profileBirthDate" placeholder="Birthdate" required ng-model="birthDateValue"/>
					</div>
				</div>
				<div class="form-group">
					<div style="padding:0px 3px;">
						<label for="profileCountry">Country</label>
					</div>
					<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
						<select id="profileCountry" class="form-control" required ng-model="profileCountriesModel" ng-options="obj.name for obj in profileCountriesOptions" ng-change="profileLoadStatesForCountry()">
							<option value="">None</option>
						</select>
					</div>
				</div>
				<div class="form-group">
					<div style="padding:0px 3px;">
						<label for="profileState">State</label>
					</div>
					<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
						<select id="profileState" class="form-control" ng-model="profileStateModel" ng-options="obj.name for obj in profileStateOptions" ng-change="profileLoadRegionsForState()">
							<option value="">None</option>
						</select>
					</div>
				</div>
				<div class="form-group">
					<div style="padding:0px 3px;">
						<label for="profileRegion">Region</label>
					</div>
					<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
						<select id="profileRegion" class="form-control" ng-model="profileRegionModel" ng-options="obj.name for obj in profileRegionOptions" >
							<option value="">None</option>
						</select>
					</div>
				</div>
				<div class="form-group">
					<div style="padding:0px 3px;">
						<label for="profileCity">City</label>
					</div>
					<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
						<input type="text" class="form-control" id="profileCity" placeholder="City" required value="{{userProfile.account.address.city}}"/>
					</div>
				</div>
				<div class="form-group">
					<div style="padding:0px 3px;">
						<label for="profileRoad">Road</label>
					</div>
					<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
						<input type="text" class="form-control" id="profileRoad" placeholder="Road" required value="{{userProfile.account.address.road}}"/>
					</div>
				</div>
				<div class="form-group">
					<div style="padding:0px 3px;">
						<label for="profilePostalCode">Postal Code</label>
					</div>
					<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
						<input type="text" class="form-control" id="profilePostalCode" placeholder="Postal Code" required value="{{userProfile.account.address.zipCode}}"/>
					</div>
				</div>
			</form>
		</fieldset>
	</div>
	<div class="tab-pane" id="creditCard">
		<div class="form-horizontal">
			<div class="form-group">
				<div style="padding:0px 3px;">
					<label for="creditCardMode">Payment Mode</label>
				</div>
				<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
					<select id="creditCardMode" required class="form-control" ng-model="creditCardModeModel" ng-options="obj.name for obj in creditCardModeOptions"></select>
				</div>
			</div>
			<div class="form-group">
				<div style="padding:0px 3px;">
					<label for="creditCardProvider">Provider</label>
				</div>
				<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
					<select id="creditCardProvider" required class="form-control" ng-model="creditCardProviderModel" ng-options="obj.name for obj in creditCardProviderOptions" ng-change="creditCardProviderChange();"></select>
				</div>
			</div>
			<form role="form" id="creditCardForm">
				<ng-include src="creditCardProviderTemplate"></ng-include>
			</form>
		</div>
	</div>
	<div class="tab-pane" id="paypal">
		<form role="form" class="form-horizontal">
			<div class="form-group">
				<div style="padding:0px 3px;">
					<label for="paypalUser">User</label>
				</div>
				<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
					<input type="text" class="form-control" id="paypalUser" placeholder="User" value="{{userProfile.paypalParam.paypalUser}}"/>
				</div>
			</div>
			<div class="form-group">
				<div style="padding:0px 3px;">
					<label for="paypalPassword">Password</label>
				</div>
				<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
					<input type="text" class="form-control" id="paypalPassword" placeholder="Password" value="{{userProfile.paypalParam.paypalPassword}}"/>
				</div>
			</div>
			<div class="form-group">
				<div style="padding:0px 3px;">
					<label for="paypalSignature">Signature</label>
				</div>
				<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
					<input type="text" class="form-control" id="paypalSignature" placeholder="Signature" value="{{userProfile.paypalParam.paypalSignature}}"/>
				</div>
			</div>
		</form>
	</div>
	<div class="tab-pane" id="kwixo">
		<form role="form" class="form-horizontal">
			<div class="form-group">
				<div style="padding:0px 3px;">
					<label for="kwixoParams">Params</label>
				</div>
				<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
					<input type="text" class="form-control" id="kwixoParams" placeholder="Params" value="{{userProfile.account.paymentConfig.kwixoParam}}"/>
				</div>
			</div>
		</form>
	</div>
	<div class="tab-pane" id="applePay">
		<form role="form" class="form-horizontal">
			<div class="form-group">
				<div style="padding:0px 3px;">
					<label for="applePayLogin">API Login ID</label>
				</div>
				<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
					<input type="text" class="form-control" id="applePayLogin" placeholder="API Login ID" value="{{applePayParam.apiLoginId}}"/>
				</div>
			</div>
			<div class="form-group">
				<div style="padding:0px 3px;">
					<label for="applePayTransactionKey">Transaction Key</label>
				</div>
				<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
					<input type="text" class="form-control" id="applePayTransactionKey" placeholder="Transaction Key" value="{{applePayParam.transactionKey}}"/>
				</div>
			</div>
		</form>
	</div>
	<div class="tab-pane" id="auth">
		<form role="form" class="form-horizontal">
			<div class="form-group">
				<div style="padding:0px 3px;">
					<label for="authEmailField">Email Field</label>
				</div>
				<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
					<input type="text" class="form-control" id="authEmailField" placeholder="Email Field" value="{{userProfile.emailField}}" required />
				</div>
			</div>
			<div class="form-group">
				<div style="padding:0px 3px;">
					<label for="authPasswordField">Password Field</label>
				</div>
				<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
					<input type="text" class="form-control" id="authPasswordField" placeholder="Password Field" value="{{userProfile.passwordField}}" required />
				</div>
			</div>
			<div class="form-group">
				<div style="padding:0px 3px;">
					<label for="authCallbackdomainField">Callback domain Field</label>
				</div>
				<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
					<input type="text" class="form-control" id="authCallbackdomainField" placeholder="Callback domain Field" value="{{userProfile.callbackPrefix}}"/>
				</div>
			</div>
			<div class="form-group">
				<div style="padding:0px 3px;">
					<label for="authPasswordRegex">Password Regex</label>
				</div>
				<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
					<input type="text" class="form-control" id="authPasswordRegex" placeholder="Password Regex" value="{{userProfile.passwordPattern}}"  ng-blur="profileCheckPasswordRegExValidity()"/>
				</div>
			</div>
		</form>
	</div>
	<div class="tab-pane" id="groupPayment">
		<form role="form" class="form-horizontal">
			<div class="form-group">
				<div style="padding:0px 3px;">
					<label for="groupPaymentUrlNextPayer">Return URL for Next Payers</label>
				</div>
				<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
					<input type="text" class="form-control" id="groupPaymentUrlNextPayer" placeholder="URL" pattern="https?://([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,4}((\/[^\/~,]+)+)?/?" value="{{userProfile.group_payment_return_url_for_next_payers}}" />
				</div>
			</div>
			<div class="form-group">
				<div style="padding:0px 3px;">
					<label for="groupPaymentSuccessURL">Success URL</label>
				</div>
				<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
					<input type="text" class="form-control" id="groupPaymentSuccessURL" placeholder="Success URL" pattern="https?://([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,4}((\/[^\/~,]+)+)?/?" value="{{userProfile.group_payment_success_url}}" />
				</div>
			</div>
			<div class="form-group">
				<div style="padding:0px 3px;">
					<label for="groupPaymentFailureURL">Failure URL</label>
				</div>
				<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
					<input type="text" class="form-control" id="groupPaymentFailureURL" placeholder="Failure URL" pattern="https?://([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,4}((\/[^\/~,]+)+)?/?" value="{{userProfile.group_payment_failure_url}}" />
				</div>
			</div>
		</form>
	</div>
	<div class="tab-pane" id="emailInfo">
		<form role="form" class="form-horizontal">
			<div class="form-group">
				<div style="padding:0px 3px;">
					<label for="emailInfoSenderMail">Sender Email</label>
				</div>
				<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
					<input type="email" class="form-control" id="emailInfoSenderMail" placeholder="Email" pattern="[a-zA-Z0-9._-]+\@([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,4}" value="{{userProfile.account.paymentConfig.senderEmail}}" />
				</div>
			</div>
			<div class="form-group">
				<div style="padding:0px 3px;">
					<label for="emailInfoSenderName">Sender Name</label>
				</div>
				<div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 3px;">
					<input type="text" class="form-control" id="emailInfoSenderName" placeholder="Name" value="{{userProfile.account.paymentConfig.senderName}}" />
				</div>
			</div>
		</form>
	</div>
</div>

<div ng-if="createPage==true">
    <form role="form" class="form-horizontal">
        <img src="{{serverUrl}}simpleCaptcha/captcha" style="margin-left: 3px;"/><br/>
        <div class="form-group">
            <div style="padding:0px 18px;">
                <label for="captchaText">Type the letters above in the box below:</label>
            </div>
            <div class="col-xs-8 col-sm-6 col-md-6 col-lg-6" style="padding:0px 18px;">
                <input type="text" class="form-control" id="captchaText" required />
            </div>
        </div>
    </form>
</div>

<div class="row row-fluid" style="margin: 0px 0px 20px 0px;">
    <div class="col-xs-8 col-sm-6 col-md-6 col-lg-6">
        <input type="button" class="btn btn-default pull-right" value="Update Profile" ng-click="saveProfile()"/>
    </div>
</div>

<div class="row-fluid" ng-show="createPage==false">
    <div class="panel panel-default">
        <div class="panel-heading"><h3 class="panel-title">Personal Card Management</h3></div>
        <div class="panel-body">
            <div class="row row-fluid">
                <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3" style="padding-top: 8px;">
                    <label for="personalCardType">Card Type</label>
                    <select id="personalCardType" class="form-control" ng-model="personalCardTypeModel" ng-options="obj.name for obj in personalCardTypeOptions"></select>
                </div>
                <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3" style="padding-top: 8px;">
                    <label for="personalCardNumber">Card Number</label>
                    <input type="text" id="personalCardNumber" class="form-control" required ng-blur="profileCheckCreditCardNumber()"/>
                </div>
                <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3" style="padding-top: 8px;">
                    <label for="personalCardHolderName">Holder Name</label>
                    <input type="text" id="personalCardHolderName" class="form-control" pattern="[0-9a-zA-Z]+" required />
                </div>
                <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3" style="padding-top: 8px;">
                    <label for="personalCardExpiryDate">Expiry Date</label>
                    <input type="month" id="personalCardExpiryDate" class="form-control" required min="{{minEpiryDate}}" />
                </div>
            </div>
            <div style="margin-top: 10px;">
                <input type="button" class="btn btn-default pull-right" value="Add" ng-click="addCard()"/>
            </div>
        </div>
    </div>
    <div class="panel panel-default" ng-repeat="card in creditCards">
        <div class="panel-heading"><h3 class="panel-title">Card #{{$index + 1}}</h3></div>
        <div class="panel-body">
            <div class="row row-fluid">
                <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3" style="padding-top: 8px;">
                    <label for="personalCardType-{{$index}}">Card Type</label>
                    <select id="personalCardType-{{$index}}" name="creditCardNumer" class="form-control" ng-model="personalCardsTypeModel[$index]" ng-options="obj.name for obj in personalCardsTypeOptions[$index]"></select>
                </div>
                <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3" style="padding-top: 8px;">
                    <label for="personalCardNumber-{{$index}}">Card Number</label>
                    <input type="text" id="personalCardNumber-{{$index}}" class="form-control" value="{{card.hiddenNumber}}" readonly />
                </div>
                <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3" style="padding-top: 8px;">
                    <label for="personalCardHolderName-{{$index}}">Holder Name</label>
                    <input type="text" id="personalCardHolderName-{{$index}}" class="form-control" pattern="[0-9a-zA-Z]+" required value="{{card.holder}}"/>
                </div>
                <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3" style="padding-top: 8px;">
                    <label for="personalCardExpiryDate-{{$index}}">Expiry Date</label>
                    <input type="month" id="personalCardExpiryDate-{{$index}}" class="form-control" required ng-model="card.expiryDateVal" min="{{minEpiryDate}}" />
                </div>
            </div>
            <div style="margin-top: 10px;">
                <input type="button" class="btn btn-danger pull-right" value="Delete" ng-click="deleteCard($index)"/>
                <input type="button" class="btn btn-info pull-right" value="Update" ng-click="updateCard($index)" style="margin-right: 10px;"/>
            </div>
        </div>
    </div>
</div>